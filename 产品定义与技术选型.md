产品说明书与技术方案设计

1. 产品概述
该产品是一个跨平台的二维 CAD/CAM 软件，主要用于零件设计、排样与 G-Code 生成，支持导入 DXF 文件并将其转换为标准的 NC 格式。系统主要面向制造业用户，帮助他们实现零件的优化排样与 CNC 加工准备。MVP 版本聚焦于零件建模、排样功能、以及 G-Code 生成与导出。

2. MVP 功能
	•	文件导入：支持 DXF 文件导入，解析并渲染其中的几何图形。
	•	零件定义：支持零件的导入与定义，零件包括几何形状、材料信息及其他加工参数。
	•	排样与套料：提供简单的排样与套料功能，根据零件的几何形状与材料板尺寸，优化布局，减少浪费。
	•	G-Code 生成与导出：将排样后的零件信息转换为标准的 NC 格式文件，供 CNC 机床使用。
	•	二维绘图界面：支持简单的二维图形编辑，包括直线、圆、矩形等基本几何元素的创建与修改。
	•	界面交互：通过直观的拖拽、缩放、选择与编辑功能，支持用户快速进行零件设计与排样操作。

⸻

3. 技术选型与架构
用户界面层（UI Layer）
	•	Electron + React + Fluent UI + Redux
	•	Electron 用于构建跨平台的桌面应用，支持 Windows、macOS 和 Linux。
	•	React 提供前端的 UI 组件，确保良好的响应式布局与用户交互。
	•	Fluent UI 作为 UI 组件库，提供现代化且一致的设计语言，提升用户体验。
	•	Redux 用于全局状态管理，维护图形对象、零件信息、排样结果、G-Code 等的数据一致性。

几何渲染层（Rendering Layer）
	•	WebGL + Three.js
	•	使用 WebGL 实现高效的硬件加速渲染，确保软件在各种平台上都能流畅运行。
	•	Three.js 作为渲染框架，负责 2D 和 3D 图形的显示与交互（主要是二维，但 Three.js 的二维功能也能够充分满足需求）。
	•	支持 DXF 文件的解析与可视化，能够渲染出包含所有几何元素的二维图形。

几何计算层（Geometry Layer）
	•	OpenCascade + WASM
	•	使用 OpenCascade 进行几何计算，处理诸如布尔运算、倒角、偏移等复杂几何操作，确保零件的设计与修改精准。
	•	将 OpenCascade 编译为 WASM，将其作为核心几何计算库直接在浏览器或桌面应用中运行，提供高效的性能。

G-Code 生成与导出层（G-Code Generation Layer）
	•	JavaScript 引擎与自定义逻辑
	•	使用 JavaScript 来编写刀具路径规划与 G-Code 生成的逻辑。
	•	通过分析 DXF 文件中的几何信息，生成刀具路径，确保计算出的路径最优。
	•	生成标准的 G-Code 文件，支持导出到 CNC 机床，确保加工精度和效率。

数据管理与存储层（Data Management & Storage Layer）
	•	JSON / Binary 格式存储
	•	使用本地存储来保存用户的工作数据（零件、图形、G-Code 等），支持 JSON 和 Binary 格式。
	•	提供文件导入与导出功能，支持 STEP、DXF、STL 等常见 CAD 格式，确保数据的兼容性。
	•	未来版本可以增加云同步功能，支持文件跨设备共享与团队协作。

⸻

4. 产品功能与技术实现
导入 DXF 文件
	•	使用 Three.js 解析 DXF 文件中的几何信息（如线条、圆形、文本等），并将其渲染为二维图形。
	•	提供基本的几何操作（选择、编辑、缩放、平移）以方便用户查看和修改导入的图形。

零件与排样管理
	•	零件管理：用户可以定义多个零件，每个零件都可以包含图形、材料信息、尺寸等数据。
	•	排样算法：通过几何算法优化零件在材料板上的布局，减少浪费。使用 JavaScript 编写简单的排样算法，计算零件的最优排布。
	•	排样显示：将排样结果以二维图形形式渲染，实时显示零件的布局，用户可以调整、修改或重新排布。

G-Code 生成
	•	根据排样后的图形和零件信息，计算出刀具路径，并生成符合标准的 G-Code 文件。
	•	支持基本的加工指令，如直线插补、圆弧插补等。
	•	支持 G-Code 文件的导出，用户可以将其下载或上传到 CNC 机床。

图形编辑与用户交互
	•	提供常用的几何图形编辑功能，如直线、矩形、圆形、偏移、拉伸等，支持用户对零件进行修改。
	•	用户通过鼠标点击与拖拽交互，实现图形的选择、调整与编辑。

⸻

5. 技术路线与学习方向
前端开发与 UI 实现
	•	学习 Electron 和 React 的基础，深入掌握组件化开发和状态管理（通过 Redux 或 Zustand）。
	•	掌握 Fluent UI 组件库，能够快速搭建现代化界面，提升用户体验。

几何计算与渲染
	•	学习 OpenCascade 的几何计算原理，掌握如何使用该库处理复杂的几何建模、布尔运算等。
	•	深入理解 WebGL 和 Three.js，优化 2D 图形渲染性能，确保流畅的用户交互体验。

G-Code 生成与 CNC 加工
	•	学习 G-Code 的语法与 CNC 加工原理，掌握刀具路径规划与生成算法，确保软件能够生成高效、精确的 G-Code 文件。
	•	研究不同 CNC 机床的特性，确保生成的 G-Code 能兼容多种设备。

⸻

6. 后续扩展与优化
	•	支持更多文件格式：如 STEP、IGES、STL 等，以兼容更多的 CAD 工具。
	•	高级排样功能：优化排样算法，支持更复杂的布局与材料切割策略。
	•	云功能：支持多设备同步与共享，促进团队协作。
	•	性能优化：利用 WebGPU 替代 WebGL，提升图形渲染与计算性能。
